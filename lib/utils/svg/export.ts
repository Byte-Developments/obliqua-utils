import { ExportConfig } from './types';
import { createBackground } from './background';
import { createWindowControls } from './window-controls';
import { createCodeContent } from './code';

export function exportToSvg(element: HTMLElement, config: ExportConfig): string {
  const { width, height } = config.dimensions;
  const { gradient } = config;

  // Base SVG structure with font definitions
  const fontDefs = `<defs>
    <style>
      @font-face {
        font-family: 'Fira Code';
        font-style: normal;
        font-weight: 400;
        src: url(data:font/woff2;base64,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) format('woff2');
        unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
      }
      text {
        font-family: 'Fira Code', monospace;
        white-space: pre;
        dominant-baseline: text-before-edge;
      }
    </style>
  </defs>`;

  // Create gradient definition if gradient exists
  const gradientDef = gradient ? `
    <defs>
      <linearGradient id="backgroundGradient" x1="0" y1="0" x2="1" y2="1">
        <stop offset="0%" stop-color="${gradient.startColor}"/>
        <stop offset="100%" stop-color="${gradient.endColor}"/>
      </linearGradient>
    </defs>
  ` : '';

  // Create main background with gradient or solid color
  const background = `<rect 
    width="100%" 
    height="100%" 
    fill="${gradient ? 'url(#backgroundGradient)' : config.theme.background}"
    rx="40" 
    ry="40"
  />`;

  // Create code container
  const codeContainer = `<rect 
    x="50" 
    y="43" 
    width="${width - 100}" 
    height="${height - 86}" 
    rx="8" 
    ry="8" 
    fill="${config.theme.background}"
  />`;

  const windowControls = config.windowControls ? createWindowControls() : '';
  const codeContent = createCodeContent(config);

  return `<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="${width}" height="${height}" viewBox="0 0 ${width} ${height}">
  ${fontDefs}
  ${gradientDef}
  ${background}
  ${codeContainer}
  ${windowControls}
  ${codeContent}
</svg>`};